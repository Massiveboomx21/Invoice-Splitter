# Εργαλείο Διάσπασης Τιμολογίων (Splitter Tool)

Ένα απλό εργαλείο με γραφικό περιβάλλον (GUI) για την αυτοματοποιημένη επεξεργασία αρχείων Excel που περιέχουν δεδομένα τιμολογίων ή παρόμοιες εγγραφές.

## Περιγραφή

Η εφαρμογή διαβάζει επιλεγμένα αρχεία Excel (.xls, .xlsx, .xlsm) και αναζητά γραμμές όπου η αξία σε μια συγκεκριμένη στήλη (π.χ., Στήλη F) υπερβαίνει ένα καθορισμένο όριο (threshold). Για κάθε τέτοια γραμμή:

1.  Δημιουργεί μια νέα, διπλανή γραμμή.
2.  Διασπά τυχαία την αρχική αξία σε δύο νέες αξίες (διασφαλίζοντας ότι το άθροισμά τους ισούται με την αρχική).
3.  Διασπά αναλογικά τις τιμές σε άλλες καθορισμένες στήλες (π.χ., Μη Υποκείμενο Ποσό, Πληρωτέο) βάσει της διάσπασης της κύριας αξίας.
4.  Χρησιμοποιεί υπολογισμούς υψηλής ακρίβειας (decimal) για οικονομικά δεδομένα.
5.  Αποθηκεύει το αποτέλεσμα σε ένα νέο αρχείο Excel με το επίθεμα `_διασπασμένο` στο όνομα, στον επιλεγμένο φάκελο εξόδου.

## Βασικά Χαρακτηριστικά

* Φιλικό γραφικό περιβάλλον χρήστη (GUI) φτιαγμένο με PyQt5.
* Ρυθμιζόμενο όριο (threshold) για τη διάσπαση.
* Ρυθμιζόμενοι αριθμοί στηλών για την κύρια αξία και τις αναλογικές στήλες.
* Επιλογή ενός ή πολλαπλών αρχείων Excel για μαζική επεξεργασία.
* Επιλογή φακέλου εξόδου για τα επεξεργασμένα αρχεία.
* Επιλογή για αυτόματη δημιουργία αντιγράφων ασφαλείας (`.backup`) των αρχικών αρχείων.
* Επιλογή για αντικατάσταση των αρχείων εξόδου αν υπάρχουν ήδη.
* Επεξεργασία στο παρασκήνιο (background thread) για να μην "παγώνει" το UI.
* Καταγραφή συμβάντων (logging) σε αρχείο και εμφάνιση στο UI.

## Απαιτήσεις

* **Λειτουργικό Σύστημα:** **Windows** (λόγω της χρήσης `win32com` για την αλληλεπίδραση με το Excel).
* **Python:** Έκδοση 3.7 ή νεότερη (προτείνεται 3.8+).
* **Εγκατεστημένο Microsoft Excel:** Απαιτείται για τη λειτουργία της βιβλιοθήκης `win32com`.
* **Βιβλιοθήκες Python:** Οι εξαρτήσεις βρίσκονται στο αρχείο `requirements.txt`.

## Εγκατάσταση Εξαρτήσεων

1.  Βεβαιώσου ότι έχεις εγκατεστημένη τη σωστή έκδοση της Python και το `pip`.
2.  Άνοιξε ένα terminal ή γραμμή εντολών (cmd/powershell).
3.  Πλοηγήσου στον κύριο φάκελο του project (`invoice_splitter/`).
4.  Εκτέλεσε την εντολή:
    ```bash
    pip install -r requirements.txt
    ```

## Εκτέλεση της Εφαρμογής

1.  Άνοιξε ένα terminal ή γραμμή εντολών.
2.  Πλοηγήσου στον κύριο φάκελο του project (`invoice_splitter/`).
3.  Εκτέλεσε την εντολή:
    ```bash
    python main.py
    ```
    (ή `python3 main.py` ανάλογα με το σύστημά σου).

## Χρήση

1.  Εκκίνησε την εφαρμογή.
2.  Στην καρτέλα "Διάσπαση Αρχείων":
    * Πάτησε "Επιλογή Αρχείου..." ή "Επιλογή Πολλαπλών..." για να διαλέξεις τα αρχεία Excel.
    * Πάτησε "Επιλογή..." δίπλα στον "Φάκελο Αποθήκευσης" για να ορίσεις πού θα σωθούν τα νέα αρχεία.
3.  Πήγαινε στην καρτέλα "Ρυθμίσεις":
    * Όρισε το "Όριο ποσού για διάσπαση".
    * Βεβαιώσου ότι οι "Αριθμοί Στηλών" αντιστοιχούν στο αρχείο σου (π.χ., 6 για F, 8 για H, 19 για S).
    * Επίλεξε αν θέλεις "Δημιουργία αντιγράφου ασφαλείας" ή "Αντικατάσταση αρχείων".
4.  Πάτησε το κουμπί "Έναρξη Επεξεργασίας" στην καρτέλα "Διάσπαση Αρχείων".
5.  Παρακολούθησε την πρόοδο στην ίδια καρτέλα και τα αναλυτικά μηνύματα στην καρτέλα "Καταγραφή".

## Δομή Project

invoice_splitter/
│
├── main.py               # Κύριο σημείο εισόδου
├── app.py                # Δημιουργία QApplication και MainWindow
├── requirements.txt      # Εξαρτήσεις Python
├── README.md             # Αυτό το αρχείο
├── .gitignore            # (Προτείνεται) Αρχεία προς αγνόηση από το Git
│
├── modules/              # Backend λογική
│   ├── init.py
│   ├── excel_processor.py
│   ├── file_manager.py
│   └── logger.py
│
├── ui/                   # Κώδικας Γραφικού Περιβάλλοντος
│   ├── init.py
│   ├── main_window.py
│   ├── dialogs.py        # (Προαιρετικό) Custom διαλόγοι
│   └── styles.py         # (Προαιρετικό) Λογική στυλ
│
├── resources/            # Στατικά αρχεία
│   ├── icons/            # (Προαιρετικό) Εικονίδια
│   └── styles/           # (Προαιρετικό) Αρχεία .qss
│
└── logs/                 # Φάκελος για τα αρχεία log (δημιουργείται αυτόματα)